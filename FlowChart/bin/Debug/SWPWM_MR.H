



.IF (CHIPSERIES = 'N588H') .OR. (CHIPSERIES = 'N588J') 
M_PWM0_ON MACRO 
 LDA BP0
 ORA #C_BIT0
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM0_OFF MACRO
 LDA BP0
 AND #C_BIT0V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM1_ON MACRO
 LDA BP0
 ORA #C_BIT1
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM1_OFF MACRO
 LDA BP0
 AND #C_BIT1V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM2_ON MACRO
 LDA BP0
 AND #C_BIT4V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM2_OFF MACRO
 LDA BP0
 ORA #C_BIT4
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM3_ON MACRO
 LDA BP0
 AND #C_BIT5V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM3_OFF MACRO
 LDA BP0
 ORA #C_BIT5
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM4_ON MACRO
 LDA BP0
 AND #C_BIT6V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM4_OFF MACRO
 LDA BP0
 ORA #C_BIT6
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0
 ENDM
M_PWM5_ON MACRO
 LDA BP0
 AND #C_BIT7V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0

 ENDM
M_PWM5_OFF MACRO
 LDA BP0
 ORA #C_BIT7
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0

 ENDM
M_PWM6_ON MACRO
 LDA BP0
 AND #C_BIT6V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0

 ENDM
M_PWM6_OFF MACRO
 LDA BP0
 ORA #C_BIT6
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0

 ENDM
M_PWM7_ON MACRO
 LDA BP0
 AND #C_BIT7V
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0

 ENDM
M_PWM7_OFF MACRO
 LDA BP0
 ORA #C_BIT7
.IF ( C_ULTRAIO_IO_EN .EQ. 1 )
 ORA BP0M_BAK
.ELSE
 ORA BP0M_USER
.ENDIF
 STA BP0

 ENDM
.ENDIF
.IF (CHIPSERIES = 'N567G') .OR. (CHIPSERIES = 'N567H') .OR. (CHIPSERIES = 'N567K').OR. (CHIPSERIES = 'N588L')
M_PWM0_ON MACRO
 LDA BP0
 AND #C_BIT0V
 STA BP0
 ENDM
M_PWM0_OFF MACRO
 LDA BP0
 ORA #C_BIT0
 STA BP0
 ENDM
M_PWM1_ON MACRO
 LDA BP0
 AND #C_BIT1V
 STA BP0
 ENDM
M_PWM1_OFF MACRO
 LDA BP0
 ORA #C_BIT1
 STA BP0
 ENDM
M_PWM2_ON MACRO
 LDA BP0
 AND #C_BIT2V
 STA BP0
 ENDM
M_PWM2_OFF MACRO
 LDA BP0
 ORA #C_BIT2
 STA BP0
 ENDM
M_PWM3_ON MACRO
 LDA BP0
 AND #C_BIT5V
 STA BP0
 ENDM
M_PWM3_OFF MACRO
 LDA BP0
 ORA #C_BIT5
 STA BP0
 ENDM
M_PWM4_ON MACRO
 LDA BP0
 AND #C_BIT6V
 STA BP0
 ENDM
M_PWM4_OFF MACRO
 LDA BP0
 ORA #C_BIT6
 STA BP0
 ENDM
M_PWM5_ON MACRO
 LDA BP0
 AND #C_BIT7V
 STA BP0

 ENDM
M_PWM5_OFF MACRO
 LDA BP0
 ORA #C_BIT7
 STA BP0

 ENDM
M_PWM6_ON MACRO
 LDA BP0
 AND #C_BIT6V
 STA BP0

 ENDM
M_PWM6_OFF MACRO
 LDA BP0
 ORA #C_BIT6
 STA BP0

 ENDM
M_PWM7_ON MACRO
 LDA BP0
 AND #C_BIT7V
 STA BP0

 ENDM
M_PWM7_OFF MACRO
 LDA BP0
 ORA #C_BIT7
 STA BP0

 ENDM
.ENDIF
.IF (CHIPSERIES = 'N589A') .OR. (CHIPSERIES = 'N589B') .OR. (CHIPSERIES = 'N589C') .OR. (CHIPSERIES = 'N589D')
M_PWM0_ON MACRO
 LDA BP0R
 ORA #11010100B
 STA BP0R
 LDA BP1R
 ORA #111B
 STA BP1R
 ENDM
M_PWM0_OFF MACRO
 LDA BP0R
 AND #00101011B
 STA BP0R
 LDA BP1R
 AND #11111000B
 STA BP1R
 ENDM
M_PWM1_ON MACRO
 LDA BP0R
 AND #C_BIT3V
 STA BP0R
 ENDM
M_PWM1_OFF MACRO
 LDA BP0R
 ORA #C_BIT3
 STA BP0R
 ENDM
M_PWM2_ON MACRO
 LDA BP0R
 AND #C_BIT4V
 STA BP0R
 ENDM
M_PWM2_OFF MACRO
 LDA BP0R
 ORA #C_BIT4
 STA BP0R
 ENDM
M_PWM3_ON MACRO
 LDA BP0R
 AND #C_BIT5V
 STA BP0R
 ENDM
M_PWM3_OFF MACRO
 LDA BP0R
 ORA #C_BIT5
 STA BP0R
 ENDM
M_PWM4_ON MACRO
 LDA BP0R
 AND #C_BIT6V
 STA BP0R
 ENDM
M_PWM4_OFF MACRO
 LDA BP0R
 ORA #C_BIT6
 STA BP0R
 ENDM
M_PWM5_ON MACRO
 LDA BP0R
 AND #C_BIT7V
 STA BP0R

 ENDM
M_PWM5_OFF MACRO
 LDA BP0R
 ORA #C_BIT7
 STA BP0R

 ENDM
M_PWM6_ON MACRO
 LDA BP0R
 AND #C_BIT6V
 STA BP0R

 ENDM
M_PWM6_OFF MACRO
 LDA BP0R
 ORA #C_BIT6
 STA BP0R

 ENDM
M_PWM7_ON MACRO
 LDA BP0R
 AND #C_BIT7V
 STA BP0R

 ENDM
M_PWM7_OFF MACRO
 LDA BP0R
 ORA #C_BIT7
 STA BP0R

 ENDM
.ENDIF


MR_START_PWMX_TM MACRO

 MR_TMGX_SET
 
 ENDM
MR_STOP_PWMX_TM MACRO

 JSR BK0_STOP_TMGX

 ENDM


M_PWM0_EN MACRO
 LDA #C_BIT0
 TSB PWM_FLAG
 ENDM
M_PWM0_DIS MACRO
 LDA #C_BIT0
 TRB PWM_FLAG
 ENDM
M_DET_PWM0_EN MACRO
 LDA #C_BIT0
 BIT PWM_FLAG
 ENDM
 
M_PWM1_EN MACRO
 LDA #C_BIT1
 TSB PWM_FLAG
 ENDM
M_PWM1_DIS MACRO
 LDA #C_BIT1
 TRB PWM_FLAG
 ENDM
M_DET_PWM1_EN MACRO
 LDA #C_BIT1
 BIT PWM_FLAG
 ENDM
M_PWM2_EN MACRO
 LDA #C_BIT2
 TSB PWM_FLAG
 ENDM
M_PWM2_DIS MACRO
 LDA #C_BIT2
 TRB PWM_FLAG
 ENDM
M_PWM3_EN MACRO
 LDA #C_BIT3
 TSB PWM_FLAG
 ENDM
M_PWM3_DIS MACRO
 LDA #C_BIT3
 TRB PWM_FLAG
 ENDM
M_PWM4_EN MACRO
 LDA #C_BIT4
 TSB PWM_FLAG
 ENDM
M_PWM4_DIS MACRO
 LDA #C_BIT4
 TRB PWM_FLAG
 ENDM
M_PWM5_EN MACRO
 LDA #C_BIT5
 TSB PWM_FLAG
 ENDM
M_PWM5_DIS MACRO
 LDA #C_BIT5
 TRB PWM_FLAG
 ENDM
M_PWM6_EN MACRO
 LDA #C_BIT6
 TSB PWM_FLAG
 ENDM
M_PWM6_DIS MACRO
 LDA #C_BIT6
 TRB PWM_FLAG
 ENDM
M_PWM7_EN MACRO
 LDA #C_BIT7
 TSB PWM_FLAG
 ENDM
M_PWM7_DIS MACRO
 LDA #C_BIT7
 TRB PWM_FLAG
 ENDM









MR_START_SWPWM_PATT MACRO VALUE


 LDX #VALUE
 JSR BK0_SWPWM_PATT_ST
 ENDM

MR_STOP_SWPWM_PATT MACRO
 JSR L_PWMS_STOP_W_CHK
 ENDM
 
MR_START_SWPWM_PATT_CON MACRO VALUE
 LDX #VALUE
 JSR BK0_LED_PATT_CON
 ENDM

MR_CHK_PATT_EN MACRO
 LDA #C_BIT7
 TSB PWM_FLAG1
 ENDM
MR_CHK_PATT_DIS MACRO
 LDA #C_BIT7
 TRB PWM_FLAG1
 ENDM
MR_DET_CHK_PATT_EN MACRO
 LDA #C_BIT7
 BIT PWM_FLAG1
 ENDM

M_SET_PWM0_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM0_LEVEL
 STA PWM0_LEVEL_BUF
 M_PWM0_OFF
 M_PWM0_EN
 ENDM
 
M_UPDATE_PWM0_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM0_LEVEL_BUF
 M_PWM0_EN
 ENDM
 
 
M_STOP_PWM0_LEVEL MACRO
 M_PWM0_DIS
 M_PWM0_OFF
 ENDM
M_SET_PWM1_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM1_LEVEL
 STA PWM1_LEVEL_BUF
 M_PWM1_OFF
 M_PWM1_EN
 ENDM
M_STOP_PWM1_LEVEL MACRO
 M_PWM1_DIS
 M_PWM1_OFF
 ENDM
M_SET_PWM2_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM2_LEVEL
 STA PWM2_LEVEL_BUF
 M_PWM2_OFF
 M_PWM2_EN
 ENDM
M_STOP_PWM2_LEVEL MACRO
 M_PWM2_DIS
 M_PWM2_OFF
 ENDM
M_SET_PWM3_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM3_LEVEL
 STA PWM3_LEVEL_BUF
 M_PWM3_OFF
 M_PWM3_EN
 ENDM
M_STOP_PWM3_LEVEL MACRO
 M_PWM3_DIS
 M_PWM3_OFF
 ENDM
M_SET_PWM4_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM4_LEVEL
 STA PWM4_LEVEL_BUF
 M_PWM4_OFF
 M_PWM4_EN
 ENDM
M_STOP_PWM4_LEVEL MACRO
 M_PWM4_DIS
 M_PWM4_OFF
 ENDM
M_SET_PWM5_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM5_LEVEL
 STA PWM5_LEVEL_BUF
 M_PWM5_OFF
 M_PWM5_EN
 ENDM
M_STOP_PWM5_LEVEL MACRO
 M_PWM5_DIS
 M_PWM5_OFF
 ENDM
M_SET_PWM6_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM6_LEVEL
 STA PWM6_LEVEL_BUF
 M_PWM6_OFF
 M_PWM6_EN
 ENDM
M_STOP_PWM6_LEVEL MACRO
 M_PWM6_DIS
 M_PWM6_OFF
 ENDM
M_SET_PWM7_LEVEL MACRO VALUE
 LDA #VALUE
 STA PWM7_LEVEL
 STA PWM7_LEVEL_BUF
 M_PWM7_OFF
 M_PWM7_EN
 ENDM
M_STOP_PWM7_LEVEL MACRO
 M_PWM7_DIS
 M_PWM7_OFF
 ENDM

MR_DET_SWPWM_PATT_EN MACRO
 LDA PWM_FLAG1
 BIT #C_BIT6
 ENDM
MR_SET_SWPWM_PATT_DIS MACRO
 LDA #C_BIT6
 TRB PWM_FLAG1
 ENDM
MR_SET_SWPWM_PATT_EN MACRO
 LDA #C_BIT6
 TSB PWM_FLAG1
 ENDM
MR_SET_SWPWM0_FIFO_START MACRO
 M_PWM0_OFF
 LDA PWM_FLAG1
 AND #11111100B
 ORA #01B
 STA PWM_FLAG1
 STZ PWM0_LEVEL
 STZ PWM0_LEVEL_BUF
 M_PWM0_EN
 ENDM
MR_SET_SWPWM0_FIFO_STOP MACRO
 M_PWM0_DIS
 M_PWM0_OFF
 LDA PWM_FLAG1
 AND #11111100B
 STA PWM_FLAG1
 STZ PWM0_LEVEL
 STZ PWM0_LEVEL_BUF
 ENDM
 


.IF ( C_SWPWM_FADEINOUT_EN .EQ. 1 )
MR_SWPWM_FADEINOUT MACRO
L_PWM0_FADE:
 LDA PWM_FLAG1 
 AND #11B
 CMP #01B
 BNE L_PWM0_FADE_S20

 LDA <PWM0_LEVEL_BUF
 CMP #C_SWPWM_MAX_LEVEL
 BEQ L_PWM0_FADE_S10
 INC <PWM0_LEVEL_BUF
 BNE L_PWM0_FADE_S100
L_PWM0_FADE_S10:
 .IF ( C_PWM0_FIFO_EN .EQ. 1)
 LDA PWM_FLAG1
 AND #11111100B
 ORA #10B
 STA PWM_FLAG1
 .ELSE
 LDA #11B
 TRB PWM_FLAG1
 .ENDIF


 BRA L_PWM0_FADE_S100
L_PWM0_FADE_S20:
 CMP #10B
 BNE L_PWM0_FADE_S100
 LDA <PWM0_LEVEL_BUF
 BEQ L_PWM0_FADE_S21
 DEC <PWM0_LEVEL_BUF
 LDA <PWM0_LEVEL_BUF
 BNE L_PWM0_FADE_S100
L_PWM0_FADE_S21:
 .IF ( C_PWM0_FIFO_EN .EQ. 1)
 LDA PWM_FLAG1
 AND #11111100B
 ORA #01B
 STA PWM_FLAG1
 .ELSE
 LDA #11B
 TRB PWM_FLAG1
 .ENDIF


L_PWM0_FADE_S100:
 ENDM
.ENDIF 

